services:
  backend:
    build:
      context: ./back
      dockerfile: Dockerfile
    environment:
      NODE_ENV: ${NODE_ENV:-production}
      PORT: 3001
      DB_HOST: ${DB_HOST:?Set DB_HOST}
      DB_PORT: ${DB_PORT:-3306}
      DB_USER: ${DB_USER:-root}
      DB_PASSWORD: ${DB_PASSWORD:?Set DB_PASSWORD}
      DB_NAME: ${DB_NAME:-final}
      DB_DIALECT: mysql
      JWT_SECRET: ${JWT_SECRET:?Set JWT_SECRET}
      CORS_ORIGINS: ${CORS_ORIGINS:-http://localhost:3000}
      FRONTEND_URL: ${FRONTEND_URL:-http://localhost:3000}
      STRIPE_SECRET_KEY: ${STRIPE_SECRET_KEY:?Set STRIPE_SECRET_KEY}
      CLOUDINARY_CLOUD_NAME: ${CLOUDINARY_CLOUD_NAME}
      CLOUDINARY_API_KEY: ${CLOUDINARY_API_KEY}
      CLOUDINARY_API_SECRET: ${CLOUDINARY_API_SECRET}
      FIREBASE_SERVICE_ACCOUNT_PATH: ${FIREBASE_SERVICE_ACCOUNT_PATH:-./auction-adca9-77aeb27bd088.json}
      SOCKET_CORS_ORIGINS: ${SOCKET_CORS_ORIGINS:-${CORS_ORIGINS:-http://localhost:3000}}
    volumes:
      - ./back/auction-adca9-77aeb27bd088.json:/app/auction-adca9-77aeb27bd088.json:ro
    restart: unless-stopped
    networks:
      - dokploy-network

networks:
  dokploy-network:
    external: true

